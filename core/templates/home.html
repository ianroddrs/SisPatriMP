{% extends 'main.html' %}
{% load static %}

{% block content %}
<main class="container-xl py-4">
  <!-- SEÇÃO DO CABEÇALHO DA PÁGINA -->
  <div class="pb-3 mb-4 border-bottom">
    <div class="d-flex align-items-center text-dark text-decoration-none">
      <span class="bg-warning text-white d-flex align-items-center justify-content-center me-3 rounded-circle" style="width: 40px; height: 40px;">
        <i class="bi bi-bar-chart-line-fill fs-5"></i>
      </span>
      <h1 class="h4 mb-0">Dashboard</h1>
    </div>
  </div>

  <!-- CARDS DE INDICADORES PRINCIPAIS (KPIs) -->
  <div class="row g-4 mb-4">
    <div class="col-lg-3 col-md-6">
      <div class="card shadow-sm h-100">
        <div class="card-body d-flex align-items-center">
          <div class="flex-shrink-0 me-3">
            <div class="bg-primary bg-opacity-10 text-primary rounded-circle d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
              <i class="bi bi-pc-display fs-4"></i>
            </div>
          </div>
          <div class="flex-grow-1">
            <h6 class="card-subtitle text-muted mb-1">Total de Equipamentos</h6>
            <p class="h4 mb-0">1,284</p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-3 col-md-6">
      <div class="card shadow-sm h-100">
        <div class="card-body d-flex align-items-center">
          <div class="flex-shrink-0 me-3">
            <div class="bg-success bg-opacity-10 text-success rounded-circle d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
              <i class="bi bi-geo-alt-fill fs-4"></i>
            </div>
          </div>
          <div class="flex-grow-1">
            <h6 class="card-subtitle text-muted mb-1">Total de Locais</h6>
            <p class="h4 mb-0">78</p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-3 col-md-6">
        <div class="card shadow-sm h-100">
          <div class="card-body d-flex align-items-center">
            <div class="flex-shrink-0 me-3">
              <div class="bg-info bg-opacity-10 text-info rounded-circle d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                <i class="bi bi-arrows-expand fs-4"></i>
              </div>
            </div>
            <div class="flex-grow-1">
              <h6 class="card-subtitle text-muted mb-1">Movimentações (Mês)</h6>
              <p class="h4 mb-0">215</p>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="card shadow-sm h-100">
          <div class="card-body d-flex align-items-center">
            <div class="flex-shrink-0 me-3">
              <div class="bg-danger bg-opacity-10 text-danger rounded-circle d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                <i class="bi bi-exclamation-triangle-fill fs-4"></i>
              </div>
            </div>
            <div class="flex-grow-1">
              <h6 class="card-subtitle text-muted mb-1">Itens em Alerta</h6>
              <p class="h4 mb-0">12</p>
            </div>
          </div>
        </div>
      </div>
  </div>

  <!-- LINHA DE GRÁFICOS PRINCIPAIS -->
  <div class="row g-4 mb-4">
    <div class="col-lg-8">
      <div class="card shadow-sm h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">Equipamentos por Local</h5>
        </div>
        <div class="card-body">
          <div id="chart-equipamentos-local"></div>
        </div>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="card shadow-sm h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">Equipamentos por Tipo</h5>
        </div>
        <div class="card-body d-flex align-items-center justify-content-center">
          <div id="chart-equipamentos-tipo"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- LINHA COM HISTÓRICO E OUTRO GRÁFICO -->
  <div class="row g-4">
    <div class="col-lg-7">
      <div class="card shadow-sm h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">Últimas Movimentações</h5>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover table-borderless mb-0 align-middle">
                    <thead class="table-light">
                        <tr>
                            <th class="ps-3">Equipamento</th>
                            <th>Origem</th>
                            <th>Destino</th>
                            <th>Data</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- DADOS DE EXEMPLO -->
                        <tr>
                            <td class="ps-3">Notebook Dell Vostro</td>
                            <td>Sala de TI</td>
                            <td>Recepção</td>
                            <td><span class="text-muted">16/06/2025 09:30</span></td>
                        </tr>
                        <tr>
                            <td class="ps-3">Monitor LG 24"</td>
                            <td>Depósito</td>
                            <td>Sala 201</td>
                            <td><span class="text-muted">15/06/2025 17:15</span></td>
                        </tr>
                        <tr>
                            <td class="ps-3">Impressora HP LaserJet</td>
                            <td>Financeiro</td>
                            <td>Marketing</td>
                            <td><span class="text-muted">15/06/2025 14:00</span></td>
                        </tr>
                        <tr>
                            <td class="ps-3">CPU Positivo</td>
                            <td>Sala 305</td>
                            <td>Manutenção</td>
                            <td><span class="text-muted">14/06/2025 11:45</span></td>
                        </tr>
                         <tr>
                            <td class="ps-3">Webcam Logitech C920</td>
                            <td>Depósito</td>
                            <td>Sala de Reuniões</td>
                            <td><span class="text-muted">14/06/2025 10:00</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="card-footer text-center bg-light">
            <a href="#" class="text-decoration-none">Ver todo o histórico <i class="bi bi-arrow-right-short"></i></a>
        </div>
      </div>
    </div>
    <div class="col-lg-5">
        <div class="card shadow-sm h-100">
          <div class="card-header">
            <h5 class="card-title mb-0">Equipamentos por Fabricante</h5>
          </div>
          <div class="card-body">
            <div id="chart-equipamentos-fabricante"></div>
          </div>
        </div>
      </div>
  </div>

</main>
<!-- CDN do ApexCharts -->
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  // ---- Gráfico de Barras: Equipamentos por Local ----
  var optionsLocal = {
    series: [{
      name: 'Quantidade',
      data: [44, 55, 57, 56, 61, 58, 63, 60, 66]
    }],
    chart: {
      type: 'bar',
      height: 350,
      toolbar: { show: false }
    },
    plotOptions: {
      bar: {
        horizontal: false,
        columnWidth: '55%',
        endingShape: 'rounded'
      },
    },
    dataLabels: { enabled: false },
    stroke: {
      show: true,
      width: 2,
      colors: ['transparent']
    },
    xaxis: {
      categories: ['Depósito', 'Sala TI', 'Recepção', 'Financeiro', 'Marketing', 'Sala 101', 'Sala 102', 'Sala 201', 'Manutenção'],
    },
    yaxis: {
      title: { text: 'Nº de equipamentos' }
    },
    fill: { opacity: 1 },
    tooltip: {
      y: {
        formatter: function (val) {
          return val + " equipamentos"
        }
      }
    }
  };
  var chartLocal = new ApexCharts(document.querySelector("#chart-equipamentos-local"), optionsLocal);
  chartLocal.render();

  // ---- Gráfico de Donut: Equipamentos por Tipo ----
  var optionsTipo = {
    series: [450, 380, 220, 150, 84],
    chart: {
      type: 'donut',
      height: 350
    },
    labels: ['Computadores', 'Monitores', 'Impressoras', 'Rede', 'Outros'],
    responsive: [{
      breakpoint: 480,
      options: {
        chart: {
          width: 200
        },
        legend: {
          position: 'bottom'
        }
      }
    }]
  };
  var chartTipo = new ApexCharts(document.querySelector("#chart-equipamentos-tipo"), optionsTipo);
  chartTipo.render();

  // ---- Gráfico de Barras Horizontais: Equipamentos por Fabricante ----
  var optionsFabricante = {
          series: [{
          data: [400, 330, 348, 290, 180, 120]
        }],
          chart: {
          type: 'bar',
          height: 350,
          toolbar: { show: false }
        },
        plotOptions: {
          bar: {
            borderRadius: 4,
            horizontal: true,
          }
        },
        dataLabels: {
          enabled: false
        },
        xaxis: {
          categories: ['Dell', 'HP', 'Lenovo', 'Positivo', 'Samsung', 'LG'],
        }
        };

    var chartFabricante = new ApexCharts(document.querySelector("#chart-equipamentos-fabricante"), optionsFabricante);
    chartFabricante.render();
});
</script>
{% endblock %}
